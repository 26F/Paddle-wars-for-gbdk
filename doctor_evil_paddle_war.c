
#include <gb/gb.h>
#include <gb/drawing.h>
#include <rand.h>

// dr. evil tiledata
const unsigned char TileData[] = {
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,0x07,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF8,0xF8,0xE0,0xE0,0x80,0x80,0x80,0x80,
0xFF,0xFF,0xFE,0xFE,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0x07,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0x1F,0x1F,0x07,0x07,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x3F,0x3F,0x0F,0x0F,0x07,0x07,
0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,
0xFE,0xFE,0xFC,0xFC,0xF8,0xF8,0xF0,0xF0,0xE0,0xE0,0xE0,0xE0,0xC0,0xC0,0x00,0x00,
0xFF,0xFF,0x7F,0x7F,0x3F,0x3F,0x1F,0x1F,0x0F,0x0F,0x07,0x07,0x03,0x03,0x01,0x01,
0xFF,0xFF,0xFE,0xFE,0xFE,0xFE,0xF8,0xF8,0xF8,0xF8,0xF0,0xF0,0xE0,0xE0,0xE0,0xE0,
0xFF,0xFF,0xFF,0xFF,0x7F,0x7F,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x1F,0x1F,0x1F,0x1F,
0xC0,0xC0,0xC0,0xC0,0x80,0x80,0x90,0x90,0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x00,
0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x07,0x07,0x07,0x07,0x07,0x07,0x03,0x03,0x03,0x03,
0xE0,0xE0,0xE0,0xE0,0xC0,0xC0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xF0,0xF0,0xF0,0xF0,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x02,
0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x03,0x0F,0x0F,0x33,0x33,0x3C,0x3C,0x70,0x70,
0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0xE0,0xF0,0xF0,0xF8,0xF8,0x1C,0x1C,0x04,0x04,
0x03,0x03,0x03,0x03,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xE0,0xE0,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xFD,0xFD,
0x00,0x00,0xC0,0xC0,0xF0,0xF0,0xDC,0xDC,0xFE,0xFE,0xFF,0xFF,0x7F,0x7F,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x02,0xF6,0xF6,0xFE,0xFE,0xF6,0xF6,
0x03,0x03,0x07,0x07,0x03,0x03,0x0F,0x0F,0x0E,0x0E,0x1C,0x1C,0x1C,0x1C,0xFA,0xFA,
0x70,0x70,0xC0,0xC0,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0xFE,
0x04,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xBF,0xBF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xFF,0xFF,
0xFE,0xFE,0xFE,0xFE,0xFC,0xFC,0xFC,0xFC,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xC7,0xC7,
0x0F,0x0F,0x07,0x07,0x00,0x00,0x3F,0x3F,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xE0,0xE0,
0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0xFC,0x24,0x24,0x08,0x08,
0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xF7,0xF7,0xF7,0xF7,0xFF,0xFF,0x96,0x96,0x0C,0x0C,0x1C,0x1C,0x02,0x02,0x00,0x00,
0x01,0x01,0x21,0x21,0xFC,0xFC,0xEF,0xEF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x18,0x18,
0x80,0x80,0xC0,0xC0,0x00,0x00,0x00,0x00,0xC0,0xC0,0x80,0x80,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x03,0x03,
0x1F,0x1F,0x6F,0x6F,0x6F,0x6F,0xEF,0xEF,0xAF,0xAF,0xAF,0xAF,0x2F,0x2F,0x0F,0x0F,
0xFF,0xFF,0xDF,0xDF,0xFF,0xFF,0xFB,0xFB,0xFF,0xFF,0xDF,0xDF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,
0xF3,0xF3,0xF3,0xF3,0xD0,0xD0,0xD0,0xD0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,
0xC8,0xC8,0xC1,0xC1,0xFE,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x08,0x08,0x88,0x88,0x08,0x08,0x08,0x08,0x08,0x08,0x10,0x10,0x30,0x30,0x30,0x30,
0x08,0x08,0x07,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x01,0x01,0xFC,0xFC,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x03,0x03,0x03,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,
0x07,0x07,0x07,0x07,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0x9F,0x9F,0x0F,0x0F,0x07,0x07,0x03,0x03,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x7F,0x0F,0x0F,
0xFF,0xFF,0xFD,0xFD,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xA0,0xA0,0xE0,0xE0,0xA0,0xA0,0xA0,0xA0,0xB8,0xB8,0xB8,0xB8,0xBE,0xBE,0xDF,0xDF,
0x30,0x30,0x20,0x20,0x20,0x20,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x60,0x60,
0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,0x1F,0x1F,0x5F,0x5F,
0x07,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0x1F,0x1F,0x1F,0x1F,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
0xDF,0xDF,0xCF,0xCF,0xCF,0xCF,0xEF,0xEF,0xEF,0xEF,0xFF,0xFF,0x35,0x35,0x35,0x35,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,
0x70,0x70,0x78,0x78,0x7C,0x7C,0x7F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x7F,
0x00,0x00,0x0B,0x0B,0x3F,0x3F,0xFC,0xFC,0xF0,0xF0,0xE0,0xE0,0x80,0x80,0x00,0x00,
0x00,0x00,0xC0,0xC0,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x0C,0x0C,0x04,0x04,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0F,0x0F,0x0F,0x0F,0x0F,0x0F,
0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x7F,0x7F,0xFF,0xFF,0xF1,0xF1,0xF0,0xF0,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x0F,0xC0,0xC0,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3F,0x3F,0xFF,0xFF,0x7F,0x7F,
0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x07,0x3F,0x3F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x37,0x37,0x37,0x37,0x76,0x76,0xFA,0xFA,0xFA,0xFA,0xFE,0xFE,0xFF,0xFF,0xFB,0xFB,
0x80,0x80,0x80,0x80,0x18,0x18,0x9C,0x9C,0x9D,0x9D,0xAF,0xAF,0xBF,0xBF,0xFF,0xFF,
0x3C,0x3C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xC1,0xC1,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFA,0xFA,0xFF,0xFF,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC8,0xC8,0xFF,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE0,0xE0,
0x0F,0x0F,0x1F,0x1F,0x1F,0x1F,0x3F,0x3F,0x3F,0x3F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xE0,0xE0,0xF8,0xF8,0xF0,0xF0,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x10,0x10,0x00,0x00,0x00,0x00,0xF2,0xF2,0xF4,0xF4,0xF0,0xF0,0xE3,0xE3,0xEF,0xEF,
0x60,0x60,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x40,0x60,0x60,0xE0,0xE0,0xE0,0xE0,
0xFF,0xFF,0x7F,0x7F,0x1F,0x1F,0x07,0x07,0x07,0x07,0x03,0x03,0x01,0x01,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xF8,0xF8,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x0C,0x0C,0x30,0x30,0x50,0x50,
0xEE,0xEE,0xEE,0xEE,0xF0,0xF0,0xC0,0xC0,0x00,0x00,0x00,0x00,0x01,0x01,0x03,0x03,
0x01,0x01,0x01,0x01,0x03,0x03,0x07,0x07,0x0F,0x0F,0x3F,0x3F,0xFF,0xFF,0xFF,0xFF,
0xFC,0xFC,0xF0,0xF0,0x01,0x01,0xBF,0xBF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,0xF0,0xF0,
0x30,0x30,0x74,0x74,0xF8,0xF8,0xF0,0xF0,0xF0,0xF0,0xC0,0xC0,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x04,0x04,0x04,
0x00,0x00,0x00,0x00,0x80,0x80,0x01,0x01,0x00,0x00,0x00,0x00,0x07,0x07,0x06,0x06,
0x07,0x07,0x47,0x47,0x2F,0x2F,0x5F,0x5F,0xF7,0xF7,0xEF,0xEF,0xCE,0xCE,0x9E,0x9E,
0xFD,0xFD,0xFD,0xFD,0xF9,0xF9,0xE9,0xE9,0xC9,0xC9,0x19,0x19,0x59,0x59,0x19,0x19,
0xEF,0xEF,0xEB,0xEB,0xFC,0xFC,0xEE,0xEE,0xFE,0xFE,0xFE,0xFE,0xF0,0xF0,0xE0,0xE0,
0xE0,0xE0,0xE0,0xE0,0x40,0x40,0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x00,
0xE0,0xE0,0xA0,0xA0,0x90,0x90,0x1C,0x1C,0x42,0x42,0x18,0x18,0x00,0x00,0x00,0x00,
0xB0,0xB0,0x80,0x80,0x00,0x00,0x00,0x00,0xD0,0xD0,0xB9,0xB9,0x73,0x73,0x32,0x32,
0x03,0x03,0x1F,0x1F,0x1F,0x1F,0x3F,0x3F,0x7F,0x7F,0xBF,0xBF,0x0F,0x0F,0x00,0x00,
0xFF,0xFF,0xFE,0xFE,0xF8,0xF8,0xF6,0xF6,0xF8,0xF8,0xFA,0xFA,0xF9,0xF9,0x07,0x07,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0xEF,0xEF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x07,0x0F,0x0F,0xFF,0xFF,
0x08,0x08,0x10,0x10,0x30,0x30,0x70,0x70,0xF0,0xF0,0xE0,0xE0,0xC1,0xC1,0xFF,0xFF,
0x07,0x07,0x1E,0x1E,0x3F,0x3F,0x1F,0x1F,0xBF,0xBF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0x78,0x78,0xF8,0xF8,0xF2,0xF2,0xF0,0xF0,0xC0,0xC0,0x80,0x80,0x80,0x80,0x00,0x00,
0x9D,0x9D,0xB3,0xB3,0x37,0x37,0x23,0x23,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0xBF,0xBF,
0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,0xFF,0xFF,0xF8,0xF8,0xF0,0xF0,0xE0,0xE0,0xF6,0xF6,
0xC0,0xC0,0x20,0x20,0x41,0x41,0xC1,0xC1,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x10,0x30,0x30,0x60,0x60,0xC0,0xC0,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x03,
0x38,0x38,0x18,0x18,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x0F,0x0F,0x0F,0x0F,
0x07,0x07,0x03,0x03,0x01,0x01,0x01,0x01,0x03,0x03,0x03,0x03,0x03,0x03,0x01,0x01,
0xFE,0xFE,0xFC,0xFC,0xF8,0xF8,0xF0,0xF0,0xC0,0xC0,0xC0,0xC0,0x80,0x80,0x00,0x00,
0x00,0x00,0x00,0x00,0x01,0x01,0x03,0x03,0x07,0x07,0x07,0x07,0x3F,0x3F,0xFE,0xFE,
0x7F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFC,0xFC,0xFC,0xFC,0x80,0x80,0x00,0x00,
0xFE,0xFE,0xFC,0xFC,0xF0,0xF0,0xC0,0xC0,0xC0,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,
0x40,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x03,0x03,0x03,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x03,0x03,0x07,0x07,0x07,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x4E,0x4E,0xFE,0xFE,0xFE,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xFE,0xFE,0xFE,0xFE,0xE0,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x03,0x03,0x07,0x07,0x3A,0x3A,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xF8,0xF8,0xA0,0xA0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
0xF8,0xF8,0xFC,0xFC,0x8E,0x8E,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x6E,0x6E,
0x0F,0x0F,0x0F,0x0F,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
0xC0,0xC0,0xC0,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0C,0x0C,
0x00,0x00,0x00,0x00,0x03,0x03,0x03,0x03,0x03,0x03,0x00,0x00,0x00,0x00,0x33,0x33,
0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0C,0x0C,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE1,0xE1,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0xF0,
0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x06,0x7E,0x7E,
0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x3F,0x3F,
0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7C,0x7C,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x33,0x33,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xB8,0xB8,
0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,0x86,
0x7F,0x7F,0x73,0x73,0x63,0x63,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,
0xCC,0xCC,0xC6,0xC6,0x06,0x06,0x06,0x06,0x06,0x06,0x02,0x02,0x03,0x03,0x03,0x03,
0x33,0x33,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x43,0x43,0xC3,0xC3,0xC3,0xC3,
0xE3,0xE3,0x63,0x63,0x60,0x60,0x60,0x60,0x61,0x61,0x63,0x63,0x63,0x63,0x63,0x63,
0xF8,0xF8,0x18,0x18,0x18,0x18,0x18,0x18,0xF8,0xF8,0xF8,0xF8,0x18,0x18,0x18,0x18,
0xFE,0xFE,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,0xC6,
0x7F,0x7F,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,0x63,
0xFE,0xFE,0xC6,0xC6,0xC6,0xC6,0xFE,0xFE,0xFE,0xFE,0xC0,0xC0,0xC0,0xC0,0xC6,0xC6,
0x03,0x03,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
0x0C,0x0C,0x9E,0x9E,0x9E,0x9E,0x9E,0x9E,0x92,0x92,0x92,0x92,0xF3,0xF3,0xF3,0xF3,
0x37,0x37,0x66,0x66,0x60,0x60,0x60,0x60,0x63,0x63,0x47,0x47,0xC6,0xC6,0xC6,0xC6,
0xF1,0xF1,0x31,0x31,0x31,0x31,0x31,0x31,0xF1,0xF1,0xF1,0xF1,0x31,0x31,0x31,0x31,
0xFC,0xFC,0xCC,0xCC,0x8C,0x8C,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x8E,0x8E,0xFC,0xFC,0xF8,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x60,0x60,0x60,0x60,0x60,0x60,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x30,0x30,0x30,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x0C,0x0C,0x0F,0x0F,0x0F,0x0F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x03,0x03,0xC1,0xC1,0xC1,0xC1,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xC3,0xC3,0x83,0x83,0x83,0x83,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x30,0x30,0x30,0x30,0x30,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x0C,0x0C,0x0F,0x0F,0x0F,0x0F,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,0x0C,
0x63,0x63,0xC3,0xC3,0x81,0x81,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x38,0x38,0xF8,0xF8,0xD8,0xD8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xC6,0xC6,0xFE,0xFE,0x7E,0x7E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x63,0x63,0x7F,0x7F,0x3F,0x3F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x18,0x18,0x18,0x18,0x18,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xC6,0xC6,0xFE,0xFE,0x7C,0x7C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xF3,0xF3,0x61,0x61,0x61,0x61,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0xC6,0xC6,0x87,0x87,0x83,0x83,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x71,0x71,0xF1,0xF1,0xB1,0xB1,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x80,0x80,0x80,0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

const unsigned char MapData[] = {
0x00,0x00,0x01,0x02,0x02,0x02,0x02,0x02,0x03,0x04,0x05,0x06,0x07,0x02,0x02,0x02,0x02,0x08,0x00,0x00,
0x00,0x00,0x01,0x02,0x02,0x02,0x02,0x09,0x00,0x00,0x00,0x00,0x00,0x0A,0x02,0x02,0x02,0x08,0x00,0x00,
0x00,0x00,0x01,0x02,0x02,0x02,0x0B,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0C,0x02,0x02,0x08,0x00,0x00,
0x00,0x00,0x01,0x02,0x02,0x02,0x0D,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0E,0x02,0x02,0x08,0x00,0x00,
0x00,0x00,0x01,0x02,0x02,0x02,0x0F,0x00,0x00,0x00,0x10,0x11,0x12,0x00,0x13,0x02,0x02,0x08,0x00,0x00,
0x00,0x00,0x01,0x02,0x02,0x02,0x14,0x15,0x16,0x00,0x17,0x18,0x19,0x00,0x1A,0x1B,0x02,0x08,0x00,0x00,
0x00,0x00,0x01,0x1C,0x02,0x02,0x1D,0x1E,0x1F,0x20,0x21,0x22,0x23,0x00,0x24,0x25,0x02,0x08,0x00,0x00,
0x00,0x00,0x01,0x26,0x02,0x27,0x28,0x29,0x2A,0x00,0x2B,0x2C,0x00,0x00,0x2D,0x2E,0x02,0x08,0x00,0x00,
0x00,0x00,0x2F,0x30,0x31,0x32,0x33,0x00,0x34,0x00,0x00,0x00,0x00,0x00,0x00,0x35,0x02,0x08,0x00,0x00,
0x00,0x00,0x00,0x00,0x36,0x37,0x38,0x39,0x3A,0x3B,0x3C,0x00,0x00,0x00,0x3D,0x3E,0x02,0x08,0x00,0x00,
0x00,0x00,0x3F,0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x00,0x3F,0x49,0x4A,0x4B,0x4C,0x00,0x00,
0x00,0x00,0x00,0x00,0x4D,0x4E,0x4F,0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x02,0x58,0x59,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x5A,0x5B,0x5C,0x5D,0x5E,0x5F,0x60,0x61,0x62,0x63,0x64,0x65,0x66,0x00,0x00,
0x00,0x00,0x00,0x00,0x67,0x68,0x69,0x00,0x6A,0x02,0x02,0x27,0x6B,0x6C,0x6D,0x6E,0x00,0x6F,0x00,0x00,
0x00,0x00,0x00,0x70,0x71,0x72,0x73,0x00,0x00,0x74,0x74,0x75,0x76,0x77,0x00,0x00,0x00,0x00,0x00,0x00,
0x78,0x79,0x7A,0x00,0x7B,0x7C,0x7D,0x7E,0x7F,0x80,0x81,0x82,0x83,0x84,0x85,0x68,0x7F,0x86,0x80,0x87,
0x78,0x88,0x89,0x00,0x7B,0x8A,0x8B,0x7E,0x7B,0x8C,0x8D,0x8E,0x8F,0x84,0x90,0x91,0x92,0x93,0x94,0x95,
0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,0xA0,0xA1,0xA2,0xA3,0xA4,0x00,0xA5,0xA6,0xA7,0xA8
};

#define Width				160
#define Height 				144
#define Centerx				Width / 2
#define Centery 			Height / 2
#define offset_y 			9
#define offset_y_player 	9
#define score_offset_x  	0
#define winloseoffset   	14
#define player_move_speed 	4

// sound channel 2
#define SND_LENGTH(N)             (N % 64)
#define WAV_DUTY(N)               (N % 4) << 6
#define ENVELOPE_STEPS(N)         (N % 8)
#define ENVELOPE_UP_OR_DOWN(N)    (N % 2) << 3
#define DEFAULT_ENVELOPE_VALUE(N) (N % 16) << 4
#define HOFD(N)                   (N % 8) // high order freq data
#define INIT_SND(N)               (N % 2) << 7

// channel 1
#define SWEEP_SHIFT(N)            (N % 8)
#define SWEEP_TIME(N)             (N % 8) << 4
#define SWEEP_INC_OR_DEC(N)       (N % 2) << 3


void ball_bounce_sound() {
        NR14_REG = INIT_SND(0);
        NR21_REG = WAV_DUTY(3) | SND_LENGTH(4);
        NR22_REG = DEFAULT_ENVELOPE_VALUE(3) | ENVELOPE_UP_OR_DOWN(0) | ENVELOPE_STEPS(1);
        NR23_REG = 0x0F; // low order freq data
        NR24_REG = INIT_SND(1);
}

void player_lose_sound() {
	    NR14_REG = INIT_SND(0) | HOFD(85); // init sound off
        NR10_REG = SWEEP_TIME(3) | SWEEP_INC_OR_DEC(189) | SWEEP_SHIFT(241);
        NR11_REG = WAV_DUTY(98) | SND_LENGTH(227);
        NR12_REG = DEFAULT_ENVELOPE_VALUE(119) | ENVELOPE_UP_OR_DOWN(82) | ENVELOPE_STEPS(214);
        NR13_REG = 150; // waveform data one byte
        NR14_REG = INIT_SND(1) | HOFD(85); // init sound on
}

void player_win_sound() {
		NR14_REG = INIT_SND(0) | HOFD(92); // init sound off
        NR10_REG = SWEEP_TIME(4) | SWEEP_INC_OR_DEC(214) | SWEEP_SHIFT(149);
        NR11_REG = WAV_DUTY(78) | SND_LENGTH(147);
        NR12_REG = DEFAULT_ENVELOPE_VALUE(39) | ENVELOPE_UP_OR_DOWN(253) | ENVELOPE_STEPS(57);
        NR13_REG = 45; // waveform data one byte
        NR14_REG = INIT_SND(1) | HOFD(92); // init sound on
}

void nice_shot_sound() {
		NR14_REG = INIT_SND(0) | HOFD(246); // init sound off
        NR10_REG = SWEEP_TIME(0) | SWEEP_INC_OR_DEC(119) | SWEEP_SHIFT(79);
        NR11_REG = WAV_DUTY(162) | SND_LENGTH(35);
        NR12_REG = DEFAULT_ENVELOPE_VALUE(181) | ENVELOPE_UP_OR_DOWN(108) | ENVELOPE_STEPS(137);
        NR13_REG = 129; // waveform data one byte
        NR14_REG = INIT_SND(1) | HOFD(246); // init sound on
	
}

void clear_text() {
	gotogxy(winloseoffset, 0);
	gprintf("      ");
	gotogxy(winloseoffset, 17);
	gprintf("      ");
}

unsigned char sprite_data[] =
{
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
  0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,
  0x18,0x18,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

void main() {
	UINT8 ballxy[2] = {Centerx, Centery};
	UINT8 player_x = Centerx;
	UINT8 enemy__x = Centerx;
	BYTE ball_move_speedx = 1;
	BYTE ball_move_speedy = 1;
	UINT8 halt = 0;
	UINT8 pause4 = 0;
	UINT8 player_score = 0;
	UINT8 enemy_score = 0;
	UWORD seed = 0;
	UINT8 paused = 0;
	UINT8 attack_type = 0;
	UINT8 hits = 0;
	// init background
	set_bkg_data(0,169, &TileData);
	set_bkg_tiles(0,0,20,18,&MapData);

	SHOW_BKG;
	waitpad(J_START);
	waitpadup();

	// init sound
	NR52_REG = 0x80; // sound on
	NR50_REG = 0x7F; // master volume
	NR51_REG = 0xFF; // enables channels

	
	
	disable_interrupts();
  	DISPLAY_OFF;

	set_sprite_data(0,4, sprite_data);
	// players sprites
	set_sprite_tile(0,0);
	set_sprite_tile(2,0);
	// enemy sprites
	set_sprite_tile(1,1);
	set_sprite_tile(3,1);

	// ball
	set_sprite_tile(4, 2);
	// player
	move_sprite(0, player_x, Width-8);
	move_sprite(2, player_x + 8, Width-8);
	// enemy
	move_sprite(1, enemy__x, 16);
	move_sprite(3, enemy__x + 8, 16);
	// ball
	move_sprite(4, Centerx, Centery);

	// seed rand for the first time.
	seed = DIV_REG;
	seed |= (UWORD)DIV_REG << 8;
	initarand(seed);



	DISPLAY_ON;
	enable_interrupts();

	// draw lines for boundery
	line(0,offset_y, 159,offset_y);
	line(0, 134, 159, 134);
	// initial score
	gotogxy(score_offset_x, 0);
	gprintf("%d", enemy_score);
	gotogxy(score_offset_x,17);
	gprintf("%d", player_score);

	// winner/loser
	gotogxy(4, 0);
	gprintf("Dr. Evil");
	gotogxy(winloseoffset, 0);
	gprintf("TIED");
	gotogxy(4, 17);
	gprintf("Powers");
	gotogxy(winloseoffset, 17);
	gprintf("TIED");

	SHOW_SPRITES;

	while (1) {

		if (joypad() & J_START) {
			waitpadup();
			paused = 1;
			}

		if(hits == 4) {
			ball_move_speedy++;
			hits = 0;
		}

		if (halt == 0) {
			ballxy[0] += ball_move_speedx;
			ballxy[1] += ball_move_speedy;
				if (joypad() & J_LEFT) {
					if (player_x > 8) {
						player_x -= player_move_speed;
					}
				
			}
			if (joypad() & J_RIGHT) {
				if (player_x + 8 < Width) {
					player_x += player_move_speed;
					
				}
			}
			
		}
		if (halt == 0) {
			if (attack_type == 0) {
				if (enemy__x + 16 < ballxy[0] + 4) {
					enemy__x += 1;
				}
				if (enemy__x > ballxy[0] + 4) {
					enemy__x -= 1;
				}
			}
			else {
				if (rand() % 2 == 0) {
					if (enemy__x + 14 < ballxy[0] + 4) {
						enemy__x += 1;
					}
					if (enemy__x + 2 > ballxy[0] + 4) {
						enemy__x -= 1;
					}
				}
				else
				{
					if (enemy__x + 10 < ballxy[0] + 4) {
						enemy__x += 1;
					}
					if (enemy__x + 6 > ballxy[0] + 4) {
						enemy__x -= 1;
					}
				}
			}
		}
		else { // halt = 1
			if (enemy__x + 4 > Centerx) {
				enemy__x--;
			}
			else if (enemy__x + 4 < Centerx) {
				enemy__x++;
			}
			if (pause4 == 0) {
				hits = 0;
				ball_move_speedy = 1;
				halt = 0;	
				ballxy[0] = Centerx;
				ballxy[1] = Centery;
				ball_move_speedx = rand() / 64;
				if ((rand()+1) % 2 == 0) {
					ball_move_speedx -= 1;
				}
				//ball_move_speedx = 0; for testing

				if (player_score > enemy_score) {
					clear_text();
					gotogxy(winloseoffset, 0);
					gprintf("LOSER");
					gotogxy(winloseoffset, 17);
					gprintf("WINNER");
				}
				else if (player_score < enemy_score) {
					clear_text();
					gotogxy(winloseoffset, 0);
					gprintf("WINNER");
					gotogxy(winloseoffset, 17);
					gprintf("LOSER");
				}
				else {
					clear_text();
					gotogxy(winloseoffset, 0);
					gprintf("TIED");
					gotogxy(winloseoffset, 17);
					gprintf("TIED");

				}

			}
			pause4--;
		}
		


		if (halt == 0) {


			if (ballxy[0] < 4) {
				ball_move_speedx *= -1;
				ball_bounce_sound();
			}
			if (ballxy[0] >= Width+4) {
				ball_move_speedx *= -1;
				ball_bounce_sound();
			}

				if (ballxy[1] < 15 + offset_y) {
				if (ballxy[0] + 4 >= enemy__x && ballxy[0] <= enemy__x + 12) { // colides with paddle
					ball_move_speedy *= -1;

					if (ballxy[0] + 4 >= enemy__x && ballxy[0] + 4 <= enemy__x + 1) {
						nice_shot_sound();
						ball_move_speedx = - 3;

					}
					else if (ballxy[0] + 6 >= enemy__x && ballxy[0] + 4 <= enemy__x + 4) {
						ball_bounce_sound(); // play sound
						ball_move_speedx = - 1;
					}
					else if (ballxy[0] >= enemy__x + 6 && ballxy[0] <= enemy__x + 10) {
						ball_bounce_sound(); // play sound
						ball_move_speedx = 1;
					}
					else if (ballxy[0] >= enemy__x + 8 && ballxy[0] <= enemy__x + 12) {
						nice_shot_sound();
						ball_move_speedx = 3;
					}
					else
					{
						ball_bounce_sound(); // play sound
						ball_move_speedx = 0;
					}
					attack_type = rand() % 2;
					hits++;
					

				}
				else // does not colide with paddle
				{
					player_win_sound();
					player_score++;
					gotogxy(score_offset_x,17);
					gprintf(" ");
					gotogxy(score_offset_x,17);
					gprintf("%d", player_score);
					halt = 1;
					pause4 = 100;
					ballxy[0] = 200;
				}
				
			}
			if (ballxy[1] >= Width-7 - offset_y_player) {
				if (ballxy[0] + 4 >= player_x && ballxy[0] <= player_x + 12) { // colides with paddle
					ball_move_speedy *= -1;
					
					if (ballxy[0] + 4 >= player_x && ballxy[0] + 4 <= player_x + 1) {
						nice_shot_sound();
						ball_move_speedx = - 3;
					}
					else if (ballxy[0] + 6 >= player_x && ballxy[0] + 4 <= player_x + 4) {
						ball_bounce_sound(); // play sound
						ball_move_speedx = - 1;
					}
					else if (ballxy[0] >= player_x + 6 && ballxy[0] <= player_x + 10) {
						ball_bounce_sound(); // play sound
						ball_move_speedx = 1;
					}
					else if (ballxy[0] >= player_x + 8 && ballxy[0] <= player_x + 12) {
						nice_shot_sound();
						ball_move_speedx = 3;
					}
					else
					{
						ball_bounce_sound(); // play sound
						ball_move_speedx = 0;
					}
					hits++;


				}
				else // does not colide with paddle
				{
					player_lose_sound();
					enemy_score++;
					gotogxy(score_offset_x, 0);
					gprintf(" ");
					gotogxy(score_offset_x, 0);
					gprintf("%d", enemy_score);
					halt = 1;
					pause4 = 100;
					ballxy[0] = 200;
				}
				
			}

		}
		else 
		{
			if (player_x + 4 > Centerx) {
				player_x--;
			}
			else if (player_x + 4 < Centerx) {
				player_x++;
			}
		}

		/// player
		move_sprite(0, player_x, Width-8 - offset_y_player);
		move_sprite(2, player_x + 8, Width-8 - offset_y_player);
		// enemy
		move_sprite(1, enemy__x, 16 + offset_y);
		move_sprite(3, enemy__x + 8, 16 + offset_y);

		//  ball
		move_sprite(4, ballxy[0], ballxy[1]);

		while (paused) {
			if (joypad() & J_START) {
				waitpadup();
				paused = 0;
			}
		}

		wait_vbl_done();
	}
}
